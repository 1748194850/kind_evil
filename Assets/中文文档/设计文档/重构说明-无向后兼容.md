# é‡æ„è¯´æ˜ - æ— å‘åå…¼å®¹ç‰ˆæœ¬

> **é‡è¦**: æœ¬æ¬¡é‡æ„**å®Œå…¨ç§»é™¤å‘åå…¼å®¹**ï¼Œæ‰€æœ‰ä»£ç å¼ºåˆ¶ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¨¡å¼

---

## ğŸ¯ è®¾è®¡åŸåˆ™

æœ¬æ¬¡é‡æ„éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š

1. **æœæ–­é‡æ„** - ä¸ä¿ç•™æ—§ä»£ç ï¼Œä¸å‘åå…¼å®¹
2. **å¼ºåˆ¶ä¾èµ–æ³¨å…¥** - æ‰€æœ‰ç»„ä»¶å¿…é¡»é€šè¿‡ServiceLocatorè·å–ä¾èµ–
3. **æ˜ç¡®é”™è¯¯** - å¦‚æœæœåŠ¡æœªæ³¨å†Œï¼Œç›´æ¥æŠ¥é”™ï¼Œä¸é™é»˜å¤±è´¥
4. **ç®€åŒ–ä»£ç ** - ç§»é™¤æ‰€æœ‰å…¼å®¹æ€§æ£€æŸ¥å’Œå›é€€é€»è¾‘

---

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. æ‰€æœ‰Playerç»„ä»¶å·²æ›´æ–°

ä»¥ä¸‹ç»„ä»¶**ä¸å†æ”¯æŒå•ä¾‹æ¨¡å¼**ï¼Œå¿…é¡»é€šè¿‡ServiceLocatorè·å–ä¾èµ–ï¼š

- `PlayerMovement.cs` - å¼ºåˆ¶ä½¿ç”¨ `IInputManager`ï¼ˆé€šè¿‡ServiceLocatorï¼‰
- `PlayerJump.cs` - å¼ºåˆ¶ä½¿ç”¨ `IInputManager`ï¼ˆé€šè¿‡ServiceLocatorï¼‰
- `PlayerSpriteFlipper.cs` - å¼ºåˆ¶ä½¿ç”¨ `IInputManager`ï¼ˆé€šè¿‡ServiceLocatorï¼‰
- `PlayerRenderInitializer.cs` - å¼ºåˆ¶ä½¿ç”¨ `ILayerManager`ï¼ˆé€šè¿‡ServiceLocatorï¼‰

**å¦‚æœServiceLocatoræœªæ³¨å†ŒæœåŠ¡ï¼Œä¼šç›´æ¥æŠ¥é”™ï¼Œä¸ä¼šå›é€€åˆ°å•ä¾‹æ¨¡å¼ã€‚**

### 2. GameInitializerå·²æ›´æ–°

- ç§»é™¤äº† `FindObjectOfType` çš„ä½¿ç”¨
- æ‰€æœ‰æ ¸å¿ƒæœåŠ¡å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™æŠ¥é”™
- ä¸å†æœ‰å¯é€‰æœåŠ¡çš„é€»è¾‘

---

## ğŸ“‹ å¿…é¡»å®Œæˆçš„é…ç½®

### 1. åœºæ™¯é…ç½®ï¼ˆå¿…é¡»ï¼ï¼‰

**åœ¨Unityç¼–è¾‘å™¨ä¸­ï¼š**

1. **æ·»åŠ GameInitializer**
   - åœ¨åœºæ™¯çš„ `Managers` GameObjectä¸Šæ·»åŠ  `GameInitializer` ç»„ä»¶
   - ç¡®ä¿ `registerOnAwake` ä¸º true

2. **è®¾ç½®æ‰§è¡Œé¡ºåºï¼ˆé‡è¦ï¼ï¼‰**
   - æ‰“å¼€ `Edit > Project Settings > Script Execution Order`
   - å°† `GameInitializer` çš„æ‰§è¡Œé¡ºåºè®¾ç½®ä¸º **-100**ï¼ˆæ¯”å…¶ä»–æ‰€æœ‰è„šæœ¬éƒ½æ—©ï¼‰
   - ç¡®ä¿ä»¥ä¸‹ç®¡ç†å™¨éƒ½åœ¨åœºæ™¯ä¸­ï¼š
     - `InputManager`
     - `LayerManager`
     - `CameraManager`
     - `EventManager`

3. **é…ç½®Player GameObject**
   - ç§»é™¤æ—§çš„ `PlayerController` ç»„ä»¶
   - æ·»åŠ æ–°ç»„ä»¶ï¼š
     - `PlayerMovement`
     - `GroundChecker`
     - `PlayerJump`
     - `PlayerSpriteFlipper`
     - `PlayerRenderInitializer`
   - é…ç½®å‚æ•°

---

## âš ï¸ é”™è¯¯å¤„ç†

### å¦‚æœå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š

**"ServiceLocator.Instance is null"**
- åŸå› ï¼šServiceLocatoræœªåˆ›å»º
- è§£å†³ï¼šç¡®ä¿GameInitializeråœ¨åœºæ™¯ä¸­ï¼Œå¹¶ä¸”æ‰§è¡Œé¡ºåºæœ€æ—©

**"IInputManager not registered in ServiceLocator"**
- åŸå› ï¼šæœåŠ¡æœªæ³¨å†Œ
- è§£å†³ï¼šç¡®ä¿GameInitializerçš„ `RegisterServices()` è¢«è°ƒç”¨ï¼Œå¹¶ä¸”InputManageråœ¨åœºæ™¯ä¸­

**"InputManager.Instance is null"**
- åŸå› ï¼šInputManagerä¸åœ¨åœºæ™¯ä¸­
- è§£å†³ï¼šåœ¨åœºæ™¯ä¸­æ·»åŠ InputManager GameObjectï¼Œå¹¶é™„åŠ InputManagerç»„ä»¶

---

## ğŸ”§ ä»£ç ç¤ºä¾‹

### æ­£ç¡®çš„ä½¿ç”¨æ–¹å¼ï¼š

```csharp
// åœ¨ç»„ä»¶ä¸­è·å–æœåŠ¡
private void Start()
{
    var serviceLocator = ServiceLocator.Instance;
    if (serviceLocator == null)
    {
        Debug.LogError("ServiceLocator not found!");
        return;
    }
    
    inputManager = serviceLocator.Get<IInputManager>();
    if (inputManager == null)
    {
        Debug.LogError("IInputManager not registered!");
        return;
    }
}
```

### é”™è¯¯çš„ä½¿ç”¨æ–¹å¼ï¼ˆå·²ç§»é™¤ï¼‰ï¼š

```csharp
// âŒ ä¸å†æ”¯æŒè¿™ç§å›é€€æ–¹å¼
if (serviceLocator.IsRegistered<IInputManager>())
{
    inputManager = serviceLocator.Get<IInputManager>();
}
else
{
    inputManager = InputManager.Instance; // âŒ å·²ç§»é™¤
}
```

---

## ğŸ“ è¿ç§»æ£€æŸ¥æ¸…å•

- [ ] GameInitializeråœ¨åœºæ™¯ä¸­
- [ ] GameInitializeræ‰§è¡Œé¡ºåºè®¾ç½®ä¸º-100
- [ ] æ‰€æœ‰ç®¡ç†å™¨éƒ½åœ¨åœºæ™¯ä¸­ï¼ˆInputManager, LayerManagerç­‰ï¼‰
- [ ] Player GameObjectä½¿ç”¨æ–°ç»„ä»¶ç³»ç»Ÿ
- [ ] ç§»é™¤äº†æ—§çš„PlayerController
- [ ] æµ‹è¯•åŠŸèƒ½æ­£å¸¸
- [ ] æ— é”™è¯¯ä¿¡æ¯

---

## ğŸ¯ ä¼˜åŠ¿

é€šè¿‡ç§»é™¤å‘åå…¼å®¹ï¼š

1. **ä»£ç æ›´ç®€æ´** - æ²¡æœ‰å¤æ‚çš„å›é€€é€»è¾‘
2. **é”™è¯¯æ›´æ˜ç¡®** - é—®é¢˜ç«‹å³æš´éœ²ï¼Œä¸ä¼šé™é»˜å¤±è´¥
3. **æ¶æ„æ›´æ¸…æ™°** - å¼ºåˆ¶ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Œç¬¦åˆè®¾è®¡åŸåˆ™
4. **ç»´æŠ¤æ›´å®¹æ˜“** - åªæœ‰ä¸€ç§æ–¹å¼ï¼Œä¸ä¼šæ··æ·†

---

**è®°ä½**: å¦‚æœé‡åˆ°é”™è¯¯ï¼Œæ£€æŸ¥GameInitializeræ˜¯å¦æ­£ç¡®é…ç½®ï¼
