# 常见问题解答

## ⚠️ "Some objects were not cleaned up when closing the scene" 警告

### 问题描述
当你关闭场景时，Unity 可能会显示以下警告：
```
Some objects were not cleaned up when closing the scene. 
(Did you spawn new GameObjects from OnDestroy?)
The following scene GameObjects were found:
InputManager
GameManager
EventManager
...
```

### 这是正常的吗？
**是的，这是完全正常的！** ✅

### 为什么会出现这个警告？

这些管理器（`InputManager`、`GameManager`、`EventManager` 等）使用了 **Singleton（单例）模式**，并且设置了 `DontDestroyOnLoad`。

这意味着：
- ✅ 它们会在场景切换时保留（这是设计目的）
- ✅ 它们不会在场景关闭时被销毁
- ✅ 它们会在整个游戏生命周期中持续存在

### 这是预期的行为

这些管理器被设计为：
1. **跨场景存在** - 在切换场景时不需要重新初始化
2. **全局访问** - 任何场景都可以通过 `Manager.Instance` 访问
3. **持久化** - 保持游戏状态和设置

### 什么时候需要担心？

只有在以下情况下才需要担心：
- ❌ 对象在场景中重复创建（多个实例）
- ❌ 对象在运行时产生内存泄漏
- ❌ 对象阻止场景正常关闭

### 如何验证 Singleton 是否正常工作？

1. **检查 Hierarchy**：
   - 在场景中应该只有一个管理器实例
   - 如果看到多个同名管理器，说明有问题

2. **检查 Console**：
   - 不应该有 "Multiple instances found" 的错误
   - 初始化消息应该只出现一次

3. **测试场景切换**：
   - 切换场景时，管理器应该保留
   - 不应该重新创建新的管理器实例

### 如何消除警告（可选）

如果你真的想消除这个警告，可以：

#### 方法 1：在编辑器中手动删除（不推荐）
- 在 Hierarchy 中找到这些管理器
- 手动删除它们
- **注意**：下次运行场景时它们会自动重新创建

#### 方法 2：接受警告（推荐）
- 这个警告是无害的
- 它只是提醒你这些对象会保留
- 这是 Singleton 模式的正常行为

### 总结

| 情况 | 是否正常 | 需要处理 |
|------|---------|---------|
| 关闭场景时出现警告 | ✅ 正常 | ❌ 不需要 |
| 多个管理器实例 | ❌ 异常 | ✅ 需要修复 |
| 管理器在场景切换时保留 | ✅ 正常 | ❌ 不需要 |
| 内存持续增长 | ❌ 异常 | ✅ 需要检查 |

### 相关代码

Singleton 实现位于：
- `Assets/Scenes/0_Core/Utilities/Singleton/Singleton.cs`

关键代码：
```csharp
protected virtual void Awake()
{
    if (instance == null)
    {
        instance = this as T;
        DontDestroyOnLoad(gameObject);  // 这会导致警告，但这是预期的
    }
}
```

---

## 其他常见问题

### Q: 管理器在 Hierarchy 中看不到？
**A**: 管理器使用 Singleton 模式，会在第一次访问时自动创建。如果你想在 Hierarchy 中看到它们，可以手动添加空对象并附加脚本。

### Q: 如何重置所有管理器？
**A**: 停止播放模式，然后重新运行场景。管理器会在 `Awake()` 时重新初始化。

### Q: 管理器会占用内存吗？
**A**: 会，但占用量很小。这些管理器只包含必要的引用和设置，不会造成内存问题。

---

**记住**：这个警告是 Unity 的正常行为，表示 Singleton 管理器正在按设计工作！🎮

